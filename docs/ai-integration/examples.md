# AI Integration Examples

This document provides real-world examples of integrating Fly CLI with various AI coding assistants and automation tools.

## Cursor Integration

### Setup Cursor with Fly CLI

1. **Install Fly CLI globally:**
```bash
dart pub global activate fly_cli
```

2. **Create a Cursor workspace configuration:**
```json
// .cursor/settings.json
{
  "fly_cli.enabled": true,
  "fly_cli.template": "riverpod",
  "fly_cli.organization": "com.yourcompany"
}
```

3. **Generate project context:**
```bash
fly context export --output=.cursor/project_context.md
```

### Cursor Chat Integration

**Prompt:** "Create a new Flutter project with authentication screens using Fly CLI"

**AI Response:** "I'll help you create a Flutter project with authentication screens using Fly CLI. Let me generate the project and add the necessary screens."

```bash
# Create the project
fly create auth_app --template=riverpod --output=json

# Add authentication screens
fly add screen login --feature=auth --type=form --with-viewmodel=true --with-tests=true --output=json
fly add screen register --feature=auth --type=form --with-viewmodel=true --with-tests=true --output=json
fly add screen forgot_password --feature=auth --type=form --with-viewmodel=true --with-tests=true --output=json

# Add authentication service
fly add service auth_api --feature=auth --type=api --base-url=https://api.yourapp.com --with-tests=true --with-mocks=true --output=json

# Export updated context
fly context export --include-dependencies=true --include-structure=true
```

## GitHub Copilot Integration

### Copilot Chat Integration

**User:** "I need to add a user profile screen with image upload functionality"

**Copilot Response:** "I'll help you add a user profile screen with image upload using Fly CLI. Let me generate the necessary components."

```bash
# Add profile screen
fly add screen profile --feature=user --type=detail --with-viewmodel=true --with-tests=true

# Add image service
fly add service image_service --feature=core --type=api --base-url=https://images.yourapp.com --with-tests=true --with-mocks=true

# Export context for future AI assistance
fly context export --include-conventions=true
```

### Copilot Code Suggestions

When working with Fly CLI generated code, Copilot can suggest improvements:

```dart
// Generated by Fly CLI
class ProfileScreen extends ConsumerWidget {
  const ProfileScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    // Copilot suggests: Add loading state handling
    final profile = ref.watch(profileProvider);
    
    return profile.when(
      data: (user) => _buildProfileContent(user),
      loading: () => const CircularProgressIndicator(),
      error: (error, stack) => _buildErrorWidget(error),
    );
  }
  
  // Copilot suggests: Add image upload functionality
  Widget _buildProfileContent(User user) {
    return Column(
      children: [
        CircleAvatar(
          backgroundImage: user.avatarUrl != null 
            ? NetworkImage(user.avatarUrl!) 
            : null,
          child: user.avatarUrl == null 
            ? const Icon(Icons.person) 
            : null,
        ),
        // Copilot suggests: Add image picker
        ElevatedButton(
          onPressed: () => _pickImage(),
          child: const Text('Change Avatar'),
        ),
      ],
    );
  }
}
```

## ChatGPT Code Interpreter Integration

### Upload Project Schema

1. **Export comprehensive project information:**
```bash
fly schema export --output=project_schema.json
fly context export --include-dependencies=true --include-structure=true --output=project_context.json
```

2. **Upload to ChatGPT Code Interpreter**

3. **Use in prompts:**
```
Based on this Fly CLI project schema, help me:
1. Add a shopping cart feature with the following requirements:
   - Cart screen with item list
   - Add/remove items functionality
   - Checkout screen
   - Payment integration service

2. Generate the Fly CLI commands to create this feature
3. Provide the implementation code for the generated components
```

### ChatGPT Response:
```bash
# Generate the shopping cart feature
fly add screen cart --feature=shopping --type=list --with-viewmodel=true --with-tests=true
fly add screen checkout --feature=shopping --type=form --with-viewmodel=true --with-tests=true
fly add service payment_api --feature=shopping --type=api --base-url=https://payments.yourapp.com --with-tests=true --with-mocks=true
fly add service cart_service --feature=shopping --type=repository --with-tests=true --with-mocks=true
```

## Claude Integration

### Claude with Fly CLI Context

**User:** "I need to migrate my existing Flutter app to use Fly CLI's Riverpod template"

**Claude Response:** "I'll help you migrate your app to Fly CLI's Riverpod template. Let me analyze your current structure and provide a migration plan."

```bash
# First, let's analyze your current project
fly context export --include-structure=true --include-dependencies=true

# Create a new Riverpod project
fly create migrated_app --template=riverpod --organization=com.yourcompany

# Generate migration context
fly context export --output=migration_context.md
```

**Migration Plan:**
1. **State Management Migration:**
   - Convert BLoC/Cubit to Riverpod providers
   - Update UI components to use ConsumerWidget
   - Migrate dependency injection

2. **Project Structure:**
   - Reorganize features into Fly CLI structure
   - Update imports and exports
   - Migrate routing to GoRouter

3. **Services Migration:**
   - Convert API clients to use fly_networking
   - Update error handling with Result types
   - Migrate to ViewState pattern

## Local AI Model Integration

### Ollama Integration

```python
import ollama
import subprocess
import json

class FlyCLIAssistant:
    def __init__(self, model="codellama"):
        self.model = model
        self.fly_agent = FlyCLIAgent()
    
    def generate_project(self, description):
        prompt = f"""
        Based on this description: "{description}"
        
        Generate Fly CLI commands to create a Flutter project with the required features.
        Use the following format:
        1. Project creation command
        2. Screen addition commands
        3. Service addition commands
        4. Context export command
        
        Return only the bash commands, one per line.
        """
        
        response = ollama.chat(model=self.model, messages=[
            {'role': 'user', 'content': prompt}
        ])
        
        commands = response['message']['content'].strip().split('\n')
        return commands
    
    def execute_commands(self, commands):
        results = []
        for cmd in commands:
            if cmd.strip().startswith('fly '):
                result = self.fly_agent._run_command(cmd.split()[1:])
                results.append(result)
        return results

# Usage
assistant = FlyCLIAssistant()
commands = assistant.generate_project(
    "A todo app with user authentication, task management, and categories"
)
results = assistant.execute_commands(commands)
```

## Automation Scripts

### Project Generator Script

```python
#!/usr/bin/env python3
"""
Automated Flutter Project Generator using Fly CLI and AI
"""

import json
import subprocess
from typing import Dict, List

class ProjectGenerator:
    def __init__(self):
        self.fly_agent = FlyCLIAgent()
    
    def generate_from_spec(self, spec: Dict) -> Dict:
        """Generate a complete project from a specification."""
        results = {}
        
        # Create base project
        project_result = self.fly_agent.create_project(
            name=spec['name'],
            template=spec.get('template', 'riverpod'),
            organization=spec.get('organization', 'com.example'),
            platforms=spec.get('platforms', ['ios', 'android'])
        )
        results['project'] = project_result
        
        # Add screens
        for screen in spec.get('screens', []):
            screen_result = self.fly_agent.add_screen(
                name=screen['name'],
                feature=screen['feature'],
                screen_type=screen.get('type', 'generic'),
                with_viewmodel=screen.get('with_viewmodel', True),
                with_tests=screen.get('with_tests', True)
            )
            results[f'screen_{screen["name"]}'] = screen_result
        
        # Add services
        for service in spec.get('services', []):
            service_result = self.fly_agent.add_service(
                name=service['name'],
                feature=service['feature'],
                service_type=service.get('type', 'api'),
                base_url=service.get('base_url'),
                with_tests=service.get('with_tests', True),
                with_mocks=service.get('with_mocks', True)
            )
            results[f'service_{service["name"]}'] = service_result
        
        # Export context
        context_result = self.fly_agent.export_context(
            include_dependencies=True,
            include_structure=True,
            include_conventions=True
        )
        results['context'] = context_result
        
        return results

# Example usage
generator = ProjectGenerator()

spec = {
    "name": "ecommerce_app",
    "template": "riverpod",
    "organization": "com.ecommerce",
    "platforms": ["ios", "android", "web"],
    "screens": [
        {"name": "home", "feature": "home", "type": "list"},
        {"name": "product_detail", "feature": "products", "type": "detail"},
        {"name": "cart", "feature": "shopping", "type": "list"},
        {"name": "checkout", "feature": "shopping", "type": "form"}
    ],
    "services": [
        {"name": "product_api", "feature": "products", "type": "api", "base_url": "https://api.ecommerce.com"},
        {"name": "cart_service", "feature": "shopping", "type": "repository"},
        {"name": "payment_api", "feature": "payments", "type": "api", "base_url": "https://payments.ecommerce.com"}
    ]
}

results = generator.generate_from_spec(spec)
print(json.dumps(results, indent=2))
```

### CI/CD Integration

```yaml
# .github/workflows/ai-project-generation.yml
name: AI Project Generation

on:
  workflow_dispatch:
    inputs:
      project_description:
        description: 'Project description for AI generation'
        required: true
        type: string

jobs:
  generate-project:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Dart
        uses: dart-lang/setup-dart@v1
        with:
          sdk: stable
      
      - name: Install Fly CLI
        run: dart pub global activate fly_cli
      
      - name: Generate Project with AI
        run: |
          # Use AI to generate project specification
          python scripts/ai_project_generator.py "${{ github.event.inputs.project_description }}"
      
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "AI Generated Project: ${{ github.event.inputs.project_description }}"
          title: "AI Generated Project"
          body: |
            This project was automatically generated using Fly CLI and AI based on the description:
            "${{ github.event.inputs.project_description }}"
```

## Best Practices

### 1. Always Use JSON Output

```bash
# Good: Machine-readable output
fly create my_app --template=riverpod --output=json

# Avoid: Human-readable only
fly create my_app --template=riverpod
```

### 2. Generate Context Regularly

```bash
# Update context after major changes
fly context export --include-dependencies=true --include-structure=true
```

### 3. Use Plan Mode for Validation

```bash
# Always preview before executing
fly create my_app --template=riverpod --plan
fly add screen home --feature=auth --plan
```

### 4. Handle Errors Gracefully

```python
try:
    result = agent.create_project("my_app", template="riverpod")
    if result['success']:
        print(f"✅ Project created: {result['data']['project_name']}")
    else:
        print(f"❌ Error: {result['error']['message']}")
        print(f"💡 Suggestion: {result['error']['suggestion']}")
except Exception as e:
    print(f"❌ Failed to create project: {e}")
```

### 5. Leverage AI-Friendly Aliases

```bash
# These are equivalent and AI-friendly
fly create my_app
fly generate my_app
fly scaffold my_app
fly new my_app
fly init my_app
```

## Troubleshooting

### Common Issues

**JSON parsing errors:**
```bash
# Ensure valid JSON output
fly create my_app --template=riverpod --output=json | jq .
```

**AI context not found:**
```bash
# Regenerate context
fly context export --output=.ai/project_context.md
```

**Command not found:**
```bash
# Check installation
fly doctor
```

### Debug Mode

```bash
# Enable verbose output
fly create my_app --template=riverpod --verbose --output=json

# Quiet mode for automation
fly create my_app --template=riverpod --quiet --output=json
```

## Next Steps

- **[JSON Schemas](/ai-integration/json-schemas)** - Detailed schema documentation
- **[Manifest Format](/ai-integration/manifest-format)** - Project specification format
- **[AI Agents](/ai-integration/agents)** - Complete integration scripts
- **[Getting Started](/guide/quickstart)** - Start using Fly CLI with AI
